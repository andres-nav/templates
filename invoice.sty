% Invoice Style Package
% A clean and simple invoice template
%
% USAGE GUIDE:
% 1. Include the package: \usepackage{invoice}
%
% 2. Set your information using these commands:
%    \myname{Your Name}
%    \myaddress{Your Address \\ Line 2 \\ City, Postal Code}
%    \myemail{your@email.com}
%    \myphone{+XX XXX XXX XXXX}
%
% 3. Set invoice details:
%    \invoicenumber{INV-2024-11-001}
%    \invoicedate{November 28, 2024}
%    \duedate{December 28, 2024}
%
% 4. Set client information:
%    \clientname{Client Name}
%    \clientcompany{Client Company Name}  % Optional
%    \clientaddress{Address \\ Line 2 \\ City, Country}
%
% 5. Set payment information:
%    \bankname{Your Bank}
%    \accountholder{Account Holder Name}
%    \iban{XX00 0000 0000 0000 0000 00}
%    \bic{XXXXXXXXX}
%
% 6. Set financial details:
%    \hourlyrate{75.00}
%    \currency{EUR}  % Optional, defaults to EUR
%    \taxrate{0}     % Optional, percentage
%    \subtotal{2,325.00}
%    \taxamount{0.00}
%    \totaldue{2,325.00}
%
% 7. In document body, use these macros:
%    \makeinvoiceheader  - Creates INVOICE title and From/To sections
%    \makebillto         - Creates Bill To section
%    \makesummary        - Creates subtotal/tax/total summary
%    \makepaymentterms   - Creates payment terms section
%    \makepaymentinfo    - Creates bank details and thank you message
%
% 8. For the services table, use standard tabularx:
%    \begin{tabularx}{\textwidth}{|l|X|r|r|r|}
%        \hline
%        \textbf{Date} & \textbf{Description} & \textbf{Hours} & \textbf{Rate} & \textbf{Amount} \\
%        \hline
%        Nov 1 & Service description & 8.0 & 75.00 & 600.00 \\
%        \hline
%    \end{tabularx}

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{invoice}[2024/11/28 Simple Invoice Template]

% Required packages
\RequirePackage[top=2cm, bottom=2cm, left=2.5cm, right=2.5cm]{geometry}
\RequirePackage{fontspec}
\RequirePackage{xcolor}
\RequirePackage{array}
\RequirePackage{tabularx}
\RequirePackage{graphicx}
\RequirePackage{calc}

% Font setup
\setmainfont{Roboto}

% Colors
\definecolor{headercolor}{RGB}{51, 51, 51}
\definecolor{linecolor}{RGB}{200, 200, 200}

% Remove page numbers
\pagestyle{empty}

% Command definitions for personal information
\newcommand{\myname}[1]{\def\@myname{#1}}
\newcommand{\myaddress}[1]{\def\@myaddress{#1}}
\newcommand{\myemail}[1]{\def\@myemail{#1}}
\newcommand{\myphone}[1]{\def\@myphone{#1}}

% Invoice information
\newcommand{\invoicenumber}[1]{\def\@invoicenumber{#1}}
\newcommand{\invoicedate}[1]{\def\@invoicedate{#1}}
\newcommand{\duedate}[1]{\def\@duedate{#1}}

% Client information
\newcommand{\clientname}[1]{\def\@clientname{#1}}
\newcommand{\clientcompany}[1]{\def\@clientcompany{#1}}
\newcommand{\clientaddress}[1]{\def\@clientaddress{#1}}

% Payment information
\newcommand{\bankname}[1]{\def\@bankname{#1}}
\newcommand{\accountholder}[1]{\def\@accountholder{#1}}
\newcommand{\iban}[1]{\def\@iban{#1}}
\newcommand{\bic}[1]{\def\@bic{#1}}

% Financial information
\newcommand{\hourlyrate}[1]{\def\@hourlyrate{#1}}
\newcommand{\currency}[1]{\def\@currency{#1}}
\newcommand{\taxrate}[1]{\def\@taxrate{#1}}
\newcommand{\subtotal}[1]{\def\@subtotal{#1}}
\newcommand{\taxamount}[1]{\def\@taxamount{#1}}
\newcommand{\totaldue}[1]{\def\@totaldue{#1}}

% Default values
\currency{EUR}
\taxrate{0}

% Macro to create invoice header
\newcommand{\makeinvoiceheader}{%
    \begin{center}
        {\Huge\bfseries\color{headercolor} INVOICE}
    \end{center}
    \vspace{0.5cm}
    
    \noindent
    \begin{minipage}[t]{0.48\textwidth}
        \textbf{From:} \\
        \@myname \\
        \@myaddress \\[0.3cm]
        Email: \@myemail \\
        Phone: \@myphone
    \end{minipage}
    \hfill
    \begin{minipage}[t]{0.48\textwidth}
        \raggedleft
        \textbf{Invoice \#:} \@invoicenumber \\
        \textbf{Date:} \@invoicedate \\
        \textbf{Due Date:} \@duedate
    \end{minipage}
    \vspace{0.8cm}
}

% Macro to create bill to section
\newcommand{\makebillto}{%
    \noindent
    \textbf{Bill To:} \\
    \@clientname \\
    \ifdefined\@clientcompany
        \@clientcompany \\
    \fi
    \@clientaddress
    \vspace{1cm}
}

% Macro to start invoice items table
\newcommand{\startinvoiceitems}{%
    \noindent
    {\large\bfseries Services Rendered}
    \vspace{0.3cm}
    
    \noindent
    \begin{tabularx}{\textwidth}{|l|X|r|r|r|}
        \hline
        \textbf{Date} & \textbf{Description} & \textbf{Hours} & \textbf{Rate (\@currency)} & \textbf{Amount (\@currency)} \\
        \hline
}

% Macro to end invoice items table
\newcommand{\closeinvoiceitems}{%
    \end{tabularx}
    \vspace{1cm}
}

% Command to add an invoice item
\newcommand{\invoiceitem}[5]{%
    #1 & #2 & #3 & #4 & #5 \\
    \hline
}

% Macro to create summary
\newcommand{\makesummary}{%
    \noindent
    \hfill
    \begin{tabular}{lr}
        \textbf{Subtotal:} & \@subtotal\ \@currency \\
        \textbf{Tax (\@taxrate\%):} & \@taxamount\ \@currency \\
        \hline
        \textbf{Total Due:} & \textbf{\@totaldue\ \@currency} \\
    \end{tabular}
    \vspace{1.5cm}
}

% Payment terms storage
\newcounter{paymenttermscount}
\setcounter{paymenttermscount}{0}

% Command to add a payment term
\newcommand{\paymentterm}[1]{%
    \stepcounter{paymenttermscount}%
    \expandafter\def\csname @paymentterm\roman{paymenttermscount}\endcsname{#1}%
}

% Macro to create payment terms
\newcommand{\makepaymentterms}{%
    \ifnum\value{paymenttermscount}>0
        \noindent
        {\large\bfseries Payment Terms}
        \vspace{0.3cm}
        
        \begin{itemize}
            \setlength\itemsep{0.2em}
            \newcounter{termcounter}
            \setcounter{termcounter}{0}
            \loop\ifnum\value{termcounter}<\value{paymenttermscount}
                \stepcounter{termcounter}
                \item \csname @paymentterm\romannumeral\value{termcounter}\endcsname
            \repeat
        \end{itemize}
        \vspace{0.8cm}
    \fi
}

% Macro to create payment information
\newcommand{\makepaymentinfo}{%
    \noindent
    {\large\bfseries Payment Information}
    \vspace{0.3cm}
    
    \noindent
    \begin{tabular}{@{}ll@{}}
        \textbf{Bank Name:} & \@bankname \\
        \textbf{Account Holder:} & \@accountholder \\
        \textbf{IBAN:} & \@iban \\
        \textbf{BIC/SWIFT:} & \@bic \\
    \end{tabular}
    \vspace{1.5cm}
}

\endinput
